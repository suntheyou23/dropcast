# 実装計画

- [x] 1. プロジェクト構造とコア機能の設定

  - Node.js プロジェクトの初期化と package.json 作成
  - 必要な依存関係の追加（aws-sdk、axios 等）
  - 基本的なディレクトリ構造の作成
  - _要件: 4.1, 4.2_

- [x] 2. Raindrop.io API クライアントの実装

  - [x] 2.1 API 認証と HTTP クライアントの実装

    - Raindrop.io API トークンを使用した認証機能
    - HTTP リクエスト用の axios クライアント設定
    - 基本的なエラーハンドリングの実装
    - _要件: 1.1, 4.3_

  - [x] 2.2 ブックマーク取得機能の実装

    - 日付フィルタを使用したブックマーク取得 API 呼び出し
    - ページネーション処理の実装（50 件超対応）
    - レスポンスデータのパースと検証
    - _要件: 1.1, 1.2_

  - [x] 2.3 ブックマーク取得機能のテスト
    - 単体テストの作成（正常系・異常系）
    - モック API レスポンスを使用したテスト
    - ページネーション処理のテスト
    - _要件: 1.1, 1.2_

- [x] 3. データ加工とフォーマット機能の実装

  - [x] 3.1 ブックマークデータモデルの実装

    - ブックマークオブジェクトの型定義
    - Raindrop.io API レスポンスからの変換機能
    - データ検証機能の実装
    - _要件: 1.2, 5.1_

  - [x] 3.2 メールフォーマット機能の実装

    - フォルダ別グループ化機能
    - 指定フォーマット（h4.、\*、★）での文字列生成
    - お気に入りマーク付与機能
    - 空データ時の処理
    - _要件: 5.1, 5.2, 5.3, 5.4, 5.6_

  - [x] 3.3 フォーマット機能のテスト
    - 各フォーマット要素の単体テスト
    - フォルダ別グループ化のテスト
    - エッジケース（空データ、特殊文字）のテスト
    - _要件: 5.1, 5.2, 5.3, 5.4_

- [x] 4. AWS SES メール送信機能の実装

  - [x] 4.1 SES クライアントの設定

    - AWS SDK v3 を使用した SES クライアント初期化
    - IAM ロール設定の確認
    - 環境変数からの設定読み込み
    - _要件: 1.4, 4.4_

  - [x] 4.2 メール送信機能の実装

    - プレーンテキストメール送信機能
    - 件名生成（日付付き）
    - 送信エラーハンドリング
    - _要件: 1.4, 5.5_

  - [x] 4.3 メール送信機能のテスト
    - モック SES を使用した単体テスト
    - メール内容の検証テスト
    - エラーケースのテスト
    - _要件: 1.4, 5.5_

- [x] 5. Lambda 関数のメイン処理実装

  - [x] 5.1 Lambda ハンドラーの実装

    - 環境変数の読み込みと検証
    - 各機能モジュールの統合
    - 実行フローの制御
    - _要件: 1.1, 1.4, 4.4_

  - [x] 5.2 エラーハンドリングとログ機能

    - CloudWatch Logs へのログ出力
    - エラーレベル別のログ記録
    - 実行結果の記録
    - _要件: 2.3, 2.4, 4.3_

  - [x] 5.3 Lambda 関数の統合テスト
    - エンドツーエンドテストの作成
    - 実際の API を使用した統合テスト
    - エラーシナリオのテスト
    - _要件: 1.1, 1.2, 1.4_

- [x] 6. AWS CDK インフラストラクチャの実装

  - [x] 6.1 CDK プロジェクトの初期化

    - CDK TypeScript プロジェクトの作成
    - 必要な CDK ライブラリの追加
    - 基本的なスタック構造の定義
    - _要件: 4.5_

  - [x] 6.2 Lambda 関数の CDK 定義

    - Lambda 関数リソースの定義
    - 環境変数の設定
    - IAM ロールとポリシーの定義
    - デプロイメント設定
    - _要件: 2.1, 4.4, 4.5_

  - [x] 6.3 EventBridge スケジュールの CDK 定義

    - 週次スケジュール（木曜日 00:00 JST）の定義
    - Lambda 関数との連携設定
    - タイムゾーン設定の確認
    - _要件: 2.1, 2.2, 4.5_

  - [x] 6.4 CloudWatch Logs の CDK 定義

    - ロググループの定義
    - 保持期間（30 日）の設定
    - Lambda 関数との連携
    - _要件: 2.3, 2.4, 4.5_

  - [x] 6.5 CDK デプロイとテスト
    - CDK スタックのデプロイ
    - リソース作成の確認
    - 設定値の検証
    - _要件: 4.5_

- [ ] 7. 本番環境での動作確認

  - [ ] 7.1 手動実行テスト

    - デプロイされた Lambda 関数の手動実行
    - 実際の Raindrop.io API からのデータ取得確認
    - 実際のメール送信の動作確認
    - CloudWatch Logs でのログ出力確認
    - _要件: 1.1, 1.2, 1.4, 2.3, 2.4_

  - [ ] 7.2 スケジュール実行の確認
    - EventBridge トリガーの動作確認
    - 初回スケジュール実行の監視
    - 継続的な動作の安定性確認
    - _要件: 2.1, 2.2, 2.3, 2.4_
